import pandas as pd

df = pd.read_csv('ONS_smoking_habits_in_the_uk_and_its_constituent_countries/Table_2.csv')

def remove_outliers_iqr(df):
    # Select numeric columns
    numeric_cols = df.select_dtypes(include=['number']).columns

    # Calculate Q1 (25th percentile) and Q3 (75th percentile)
    Q1 = df[numeric_cols].quantile(0.25)
    Q3 = df[numeric_cols].quantile(0.75)
    IQR = Q3 - Q1

    # Define outliers as those lying outside 1.5 * IQR from Q1 and Q3
    lower_bound = Q1 - 1.5 * IQR
    upper_bound = Q3 + 1.5 * IQR

    # Filter out outliers
    df_outliers_removed = df[~((df[numeric_cols] < lower_bound) | (df[numeric_cols] > upper_bound)).any(axis=1)]
    return df_outliers_removed

# Apply to remove outliers
df_cleaned = remove_outliers_iqr(df)

print("Dataset after removing outliers:")
print(df_cleaned.head())

# saved the cleaned dataset to a new file
df_cleaned.to_csv('cleaned_dataset_Table 2.csv', index=False)